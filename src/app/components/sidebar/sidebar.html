<aside class="sidebar">
  <header class="sidebar__header">
    <div class="workspace">
      <div class="workspace__logo" aria-hidden="true">
        <img class="workspace__logo-img" src="/main-page/workspace-logo.svg" alt="" />
      </div>
      <div class="workspace__name text--regular">Devspace</div>
    </div>

    <button class="icon-btn" type="button" aria-label="Neue Nachricht">
      <img class="icon-btn__img" src="/main-page/edit_square.svg" alt="" />
    </button>
  </header>

  <div class="sidebar__content">
    <section class="section">
      <div class="section__title-row">
        <div class="section__title" (click)="toggleChannels()">
          <img class="icon-btn__img arrow-icon" [class.rotate-icon]="!channelsOpen" src="/main-page/arrow_drop_down.svg"
            alt="" />
          <img class="icon-btn__img" src="/main-page/workspaces.svg" alt="" />
          <span class="text--small section__label">Channels</span>
        </div>

        <button class="icon-btn" type="button" aria-label="Channel hinzufügen" (click)="openCreateChannel()">
          <img class="icon-btn__img" src="/main-page/add.svg" alt="" />
        </button>
      </div>

      <nav class="list" [class.collapsed]="!channelsOpen" aria-label="Channel Liste">
        @for (channel of firebaseService.channels; track channel.id) {
        <div class="list__item" (click)="selectChannel(channel.id)"
          [class.list__item--active]="channel.id === firebaseService.selectedChannelId">
          <img class="input-icon" src="/main-page/tag1.svg" alt="#" />
          <span class="text--small">{{ channel.name }}</span>
        </div>
        }

        <button class="list__item list__item--add" type="button" (click)="openCreateChannel()">
          <img class="icon-btn__img" src="/main-page/add_circle.svg" alt="+" />
          <span class="text--small">Channel hinzufügen</span>
        </button>
      </nav>
    </section>

    <section class="section">
      <div class="section__title-row">
        <div class="section__title" (click)="toggleDm()">
          <img class="icon-btn__img arrow-icon" [class.rotate-icon]="!dmOpen" src="/main-page/arrow_drop_down.svg"
            alt="" />
          <img class="input-icon" src="/main-page/account_circle.svg" alt="" />
          <span class="text--small section__label">Direktnachrichten</span>
        </div>
      </div>

      <nav class="list" [class.collapsed]="!dmOpen" aria-label="Direktnachrichten Liste">
        @for (user of displayAllUsersSidebar(); track user.uid) {
        <a class="list__item" (click)="selectDm(); displayForeignUserService.setSelectedUser(user); displayForeignUserService.setToTrue();">
          <span class="avatar">
            <img src="{{ user.avatar }}" alt="" class="avatar__img" />
            <span class="status status--online" aria-hidden="true"></span>
          </span>
          <span class="text--small">
            {{ user.firstName }} {{ user.lastName }}
            @if (user.uid === firebaseService.currentUser()?.uid) {
            <span> (Du)</span>
            }
          </span>
        </a>
        }
        <!-- Keep this user as example for offline status-->
        <a class="list__item" (click)="selectDm();">
          <span class="avatar">
            <img src="/shared/profile-pics/profile-pic2.svg" alt="Profilbild" class="avatar__img" />
            <span class="status status--offline" aria-hidden="true"></span>
          </span>
          <span class="text--small">Sofia Müller</span>
        </a>
      </nav>
    </section>
  </div>

  @if (isCreateChannelOpen) {
  <div class="modal-backdrop" (click)="closeCreateChannel()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal__header">
        <h2>Channel erstellen</h2>
        <button class="icon-btn" (click)="closeCreateChannel()">
          <img class="icon-btn__img" src="/main-page/close-button.svg" alt="Schließen" />
        </button>
      </div>

      <p class="modal__text text--regular">
        Channels dienen deinem Team zur Kommunikation. Am besten sollten sie themenbezogen sein.
        #marketing zum Beispiel
      </p>

      <div class="modal__form">
        <div class="input-group">
          <label class="modal__label text--small bold">Channel-Name</label>
          <div class="input-wrapper">
            <img class="input-icon" src="/main-page/tag.svg" alt="#" />
            <input class="inputfield--dialogs with-icon" type="text" placeholder="z.B. Kooperationsprojekte"
              [(ngModel)]="channelName" />
          </div>
        </div>

        <div class="input-group">
          <label class="modal__label text--small bold">Beschreibung <span>(optional)</span></label>
          <input class="inputfield--dialogs" type="text" placeholder="Dein Text hier"
            [(ngModel)]="channelDescription" />
        </div>
      </div>
      <div class="modal__footer">
        <button class="btn--primary" type="button" (click)="proceedToAddMembers()">Weiter</button>
      </div>
    </div>
  </div>
  }

  @if (isAddPeopleOpen) {
  <div class="modal-backdrop">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modal__header">
        <h2>Leute hinzufügen</h2>
        <button class="icon-btn" (click)="closeAddPeople()">
          <img class="icon-btn__img" src="/main-page/close-button.svg" alt="Schließen" />
        </button>
      </div>

      <div class="modal__radio-section">
        <div class="radio-option">
          <input type="radio" id="all-members" name="add-members" value="all" [(ngModel)]="addPeopleOption" />
          <label for="all-members" class="text--regular"> Alle Mitglieder hinzufügen </label>
        </div>

        <div class="radio-option">
          <input type="radio" id="specific-members" name="add-members" value="specific" [(ngModel)]="addPeopleOption" />
          <label for="specific-members" class="text--regular"> Bestimmte Leute hinzufügen </label>
        </div>
      </div>

      <div class="modal__footer">
        <button class="btn--primary" type="button" [disabled]="isCreating"
          (click)="createChannel(); $event.stopPropagation()">
          Erstellen
        </button>
      </div>
    </div>
  </div>
  }
</aside>